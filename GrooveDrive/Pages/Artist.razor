@page "/Artist/{name}"

@using Microsoft.AspNetCore.Authorization
@using Microsoft.Graph

@attribute [Authorize]
@inject PlayerState _playerState

<PageTitle>Artist - @Name</PageTitle>

@if (_playerState.IsLoading)
{
    <Spinner />
}
else
{
    if (!string.IsNullOrWhiteSpace(Name) && _playerState.SongsByArtistName(Name) is not null)
    {
        <SongsContainer>
            @foreach (var item in _playerState.SongsByArtistName(Name))
            {
                <SongListItem Title="@GetTitle(item)" Text="@($"{item.Audio?.Album}\n{item.Audio?.Artist}")" DriveItem="item" ClickHandler="@(() => _playerState.Play(item))" />
            }
        </SongsContainer>
    }
}

@code {
    [Parameter]
    public string? Name { get; set; }

    private string GetTitle(DriveItem item) => item is null ? "" : item.Audio is null ? item.Name : item.Audio.Title;
}
